/*!
 * Proa Tools Records v1.9.3 (https://github.com/proa-data/proa-tools-records)
 */
angular.module("proaTools.records",["ui.bootstrap"]),function(){function t(t){t.maxSize=10,t.forceEllipses=!0,t.previousText=t.nextText=null,t.boundaryLinkNumbers=!0}t.$inject=["uibPaginationConfig"],angular.module("proaTools.records").config(t)}(),angular.module("proaTools.records").constant("PT_RECORDS_TEXTS",{number:"#",noData:"No data",deletionConfirmation:"Do you really want to delete?"}),function(){t.$inject=["$filter","uibPaginationConfig"],n.$inject=["PT_RECORDS_TEXTS"],e.$inject=["PT_RECORDS_TEXTS"],i.$inject=["$compile"],o.$inject=["getPaginationDirectiveOptions"],r.$inject=["getPaginationDirectiveOptions"],c.$inject=["$window","PT_RECORDS_TEXTS"],angular.module("proaTools.records").directive("ptList",t).directive("ptListLabels",n).directive("ptListValues",e).factory("getPaginationDirectiveOptions",i).directive("paginationPrev",o).directive("paginationNext",r).directive("ptOrder",function(){return{restrict:"A",scope:!0,compile:function(t){var r="$prop";return t.append('<button type="button" class="btn btn-default btn-xs pull-right btn-pt-records" ng-class="{active: '+T.IS_ACTIVE+"("+r+')}" ng-click="'+T.SORT+"("+r+')"><span class="fas" ng-class="'+T.GET_ICON_CLASS+"("+r+')"></span></button>'),function(n,t,e){var i=this.name;n.$watch(function(){return e[i]},function(t){n[r]=t});var a=e.ptOrderInit;if(a)switch(n[T.INITIAL_ORDERED_PROPERTY]=e[i],a){case"desc":o();case"asc":o()}function o(){n[T.SORT](n[T.INITIAL_ORDERED_PROPERTY])}}}}}).directive("ptItem",c).directive("tableSticky",function(){return{restrict:"C",link:function(t,n){var o=n.children(".table"),e=o.find("caption").outerHeight()||0;function i(t,n,e,i){var a=i(o,!0);o.children().filter(t).children("tr:not("+n+")").each(function(){var t=$(this);t.children("th, td").css(e,Math.abs(i(t)-a))})}function a(t,n){return t.position().top+(n?e:0)}i("caption + thead, colgroup + thead, thead:first-child",":first-child","top",a),i("tfoot",":last-child","bottom",function(t,n){return a(t,n)+t.outerHeight()})}}});var T={LIST:"$list",TOTAL_LIST:"$totalList",GET_ROW_NUMBER:"$getRowNumber",SORT:"$sort",IS_ACTIVE:"$isActive",GET_ICON_CLASS:"$getIconClass",INITIAL_ORDERED_PROPERTY:"$$initialOrderedProperty",IS_EDITING:"$isEditing",ITEM_SN:"$$itemSn"},E="$$index",a="pagination-pt-records",I="$$isEditing";function t(r,c){t.$inject=["$scope","$attrs"];var s={CURRENT_PAGE:"$currentPage",ENABLED_PAGINATION:"$enabledPagination",TOGGLE_PAGINATION:"$togglePagination",EXPORTING_TABLE:"$$exportingTable",EXPORT_TO_XLS:"$exportToXls"};return{restrict:"A",scope:!0,controller:t,compile:function(t){var e="pt-item";return t.prepend('<caption class="pt-records-toolbar clearfix" ng-show="'+T.TOTAL_LIST+'.length"><ul uib-pagination total-items="'+T.TOTAL_LIST+'.length" ng-model="'+s.CURRENT_PAGE+'" class="'+a+' pull-left" ng-show="'+s.ENABLED_PAGINATION+'"></ul><div class="btn-group pull-right" role="toolbar"><button type="button" class="btn btn-default" ng-click="'+s.TOGGLE_PAGINATION+'()"><span class="fa-stack fa-stack-pt-records" ng-if="'+s.ENABLED_PAGINATION+'"><span class="far fa-file fa-stack-1x"></span><span class="fas fa-slash fa-stack-1x"></span></span><span class="far fa-file" ng-if="!'+s.ENABLED_PAGINATION+'"></span></button><button type="button" class="btn btn-default" ng-click="'+s.EXPORT_TO_XLS+'()"><span class="fas fa-file-excel"></span></button></div></caption>').find("tbody").attr("pt-list-values","").find("["+e+"]").each(function(){var t=$(this),n=g(t.attr(e));t.attr("ng-repeat",n+" in "+T.LIST).attr("ng-class","{'pt-item-editing': "+n+"."+I+"}")}).end().end().find("thead,tfoot").find("tr:first").attr("pt-list-labels",""),function(t,n){t[s.EXPORTING_TABLE]=n.get(0)}}};function t(e,t){var i=r("limitTo"),a=r("orderBy");e[T.LIST]=[],e[T.TOTAL_LIST]=[],e[s.CURRENT_PAGE]=1,e[s.ENABLED_PAGINATION]=void 0===t.ptNoPagination,e[s.TOGGLE_PAGINATION]=function(){e[s.ENABLED_PAGINATION]=!e[s.ENABLED_PAGINATION]},e[T.GET_ROW_NUMBER]=function(t){e[s.ENABLED_PAGINATION]&&(t=(e[s.CURRENT_PAGE]-1)*c.itemsPerPage+t);return t+1};var o={desc:!(e[s.EXPORT_TO_XLS]=function(){XLSX.writeFile(XLSX.utils.table_to_book(e[s.EXPORTING_TABLE],{raw:!0}),(t.ptFilename||"Excel")+".xlsx")})};function n(){var t=a(e[T.TOTAL_LIST],o.property,o.desc);if(e[s.ENABLED_PAGINATION]){var n=c.itemsPerPage;t=i(t,n,(e[s.CURRENT_PAGE]-1)*n)}e[T.LIST]=t}e[T.SORT]=function(t){o.property==t?(o.desc&&(t=void 0),o.desc=!o.desc):o.desc=!1;o.property=t},e[T.IS_ACTIVE]=function(t){return o.property==t},e[T.GET_ICON_CLASS]=function(t){return"fa-sort"+(o.property==t?"-"+(o.desc?"down":"up"):"")},e.$watchCollection(t.ptList,function(t){angular.forEach(t,function(t,n){t[E]=n}),e[T.TOTAL_LIST]=t,n()}),e.$watch(s.CURRENT_PAGE,n),e.$watch(s.ENABLED_PAGINATION,n),e.$watchCollection(function(){return o},n)}}function n(e){return{restrict:"A",compile:function(t){var n=t.parent();t.prepend($(n.is("thead")?"<th>"+e.number+"</th>":'<th class="invisible"></th>').prop("rowspan",n.find("tr").length))}}}function e(n){return{restrict:"A",compile:function(t){t.append('<tr ng-if="!'+T.TOTAL_LIST+'.length"><td colspan="9999">'+n.noData+"</td></tr>")}}}function i(i){return function(e){return{restrict:"C",link:function(t,n){n.parent(".pagination."+a).length&&n.children("a").html(i('<span class="fas fa-chevron-'+(e?"right":"left")+'"></span>')(t))}}}}function o(t){return t()}function r(t){return t(!0)}function c(r,c){var s="ptItemManage",l="$$old",u="$startEdition",f="$delete",p="$edit",d="$cancelEdition";return{restrict:"A",compile:function(t,n){t.prepend('<td class="text-right">{{'+T.GET_ROW_NUMBER+"($index) | number}}</td>");var e=n[s];if(e){var i=g(n[this.name]);t.append('<td><div class="btn-group" role="toolbar" ng-hide="'+T.IS_EDITING+"("+i+')"><button type="button" class="btn btn-default" ng-click="'+u+"("+i+')" ng-if="'+e+'.edit"><span class="fas fa-edit fa-fw"></span></button><button type="button" class="btn btn-default" ng-click="'+f+"("+i+')" ng-if="'+e+'.delete"><span class="fas fa-trash fa-fw"></span></button></div><div class="btn-group" role="toolbar" ng-if="'+e+'.edit" ng-show="'+T.IS_EDITING+"("+i+')"><button type="button" class="btn btn-default" ng-click="'+p+"("+i+')"><span class="fas fa-check fa-fw"></span></button><button type="button" class="btn btn-default" ng-click="'+d+"("+i+')"><span class="fas fa-times fa-fw"></span></button></div></td>')}return function(n,t,e){n[T.ITEM_SN]=g(e[this.name]);var i=n.$eval(e[s]);if(!i)return;function a(t,n){t&&t.then?t.then(function(){n()}):n()}function o(t){delete t[l],delete t[I]}n[u]=function(t){t[l]=angular.copy(t),t[I]=!0},n[f]=function(t){r.confirm(c.deletionConfirmation)&&a(i.delete(t),function(){n[T.TOTAL_LIST].splice(t[E],1)})},n[p]=function(t){a(i.edit(t,t[l]),function(){o(t)})},n[d]=function(i){angular.forEach(i,function(t,n){switch(n){case E:case l:case I:break;default:var e=i[l][n];void 0===e?delete i[n]:i[n]=e}}),o(i)},n[T.IS_EDITING]=function(t){return t[I]}}},priority:1001}}function g(t){return t||"$item"}}();