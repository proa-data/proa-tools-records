/*!
 * Proa Tools Records v1.8.0 (https://github.com/proa-data/proa-tools-records)
 */
angular.module("proaTools.records",["ui.bootstrap"]),function(){function t(t){t.maxSize=10,t.forceEllipses=!0,t.previousText=t.nextText=null,t.boundaryLinkNumbers=!0}t.$inject=["uibPaginationConfig"],angular.module("proaTools.records").config(t)}(),angular.module("proaTools.records").constant("PT_RECORDS_TEXTS",{number:"#",noData:"No data",deletionConfirmation:"Do you really want to delete?"}),function(){t.$inject=["$filter","uibPaginationConfig","PT_RECORDS_TEXTS","$compile"],n.$inject=["$compile"],e.$inject=["getPaginationDirectiveOptions"],i.$inject=["getPaginationDirectiveOptions"],o.$inject=["getCompiledDirectiveOptions"],r.$inject=["getCompiledDirectiveOptions","confirmDeletion"],a.$inject=["getCompiledDirectiveOptions"],c.$inject=["getPtItemManageDirectiveOptions"],s.$inject=["getPtItemManageDirectiveOptions"],angular.module("proaTools.records").directive("ptList",t).factory("getPaginationDirectiveOptions",n).directive("paginationPrev",e).directive("paginationNext",i).directive("ptOrder",o).directive("ptOrderInit",function(){return{restrict:"A",link:function(t,n,e){switch(e[this.name]){case"desc":i();case"asc":i()}function i(){t[g.SORT](t[g.INITIAL_ORDERED_PROPERTY])}}}}).directive("ptItem",r).factory("getPtItemManageDirectiveOptions",a).directive("ptItemManageOutput",c).directive("ptItemManageInput",s).directive("tableSticky",function(){return{restrict:"C",link:function(t,n){var c=n.children(".table");function e(t,n,e,i){var o=c.children().filter(t).children("tr:not("+n+")"),r=i(o),a=i(c);o.children("th, td").css(e,Math.abs(r-a))}function i(t){return t.position().top}e("caption + thead, colgroup + thead, thead:first-child",":first-child","top",i),e("tfoot",":last-child","bottom",function(t){return i(t)+t.outerHeight()})}}});var g={LIST:"$list",TOTAL_LIST:"$totalList",GET_ROW_NUMBER:"$getRowNumber",SORT:"$sort",IS_ACTIVE:"$isActive",GET_ICON_CLASS:"$getIconClass",INITIAL_ORDERED_PROPERTY:"$$initialOrderedProperty",IS_EDITING:"$isEditing"},I="$$index",u="pagination-pt-records";function t(a,c,r,s){t.$inject=["$scope","$attrs"];var l={CURRENT_PAGE:"$currentPage",ENABLED_PAGINATION:"$enabledPagination",TOGGLE_PAGINATION:"$togglePagination",EXPORTING_TABLE:"$$exportingTable",EXPORT_TO_XLS:"$exportToXls"};return{restrict:"A",scope:!0,controller:t,compile:function(){return function(n,t){var e=0;t.find("thead > tr:first").prepend(o('<th rowspan="'+t.find("thead > tr").length+'">'+r.number+"</th>")).find("th").each(function(){e+=angular.element(this).prop("colspan")}).end().end().find("tbody").append(o('<tr ng-if="!'+g.TOTAL_LIST+'.length"><td colspan="'+e+'">'+r.noData+"</td></tr>")),n[l.EXPORTING_TABLE]=t.get(0);var i=t.parent();i.hasClass("table-responsive")&&(t=i);function o(t){return s(t)(n)}t.before(o('<div class="clearfix" ng-show="'+g.TOTAL_LIST+'.length"><ul uib-pagination total-items="'+g.TOTAL_LIST+'.length" ng-model="'+l.CURRENT_PAGE+'" class="'+u+' pull-left" ng-show="'+l.ENABLED_PAGINATION+'"></ul><div class="btn-group pull-right" role="toolbar"><button type="button" class="btn btn-default" ng-click="'+l.TOGGLE_PAGINATION+'()"><span class="fa-stack fa-stack-pt-records" ng-if="'+l.ENABLED_PAGINATION+'"><span class="far fa-file fa-stack-1x"></span><span class="fas fa-slash fa-stack-1x"></span></span><span class="far fa-file" ng-if="!'+l.ENABLED_PAGINATION+'"></span></button><button type="button" class="btn btn-default" ng-click="'+l.EXPORT_TO_XLS+'()"><span class="fas fa-file-excel"></span></button></div></div>'))}}};function t(e,t){var i=a("limitTo"),o=a("orderBy");e[g.LIST]=[],e[g.TOTAL_LIST]=[],e[l.CURRENT_PAGE]=1,e[l.ENABLED_PAGINATION]=void 0===t.ptNoPagination,e[l.TOGGLE_PAGINATION]=function(){e[l.ENABLED_PAGINATION]=!e[l.ENABLED_PAGINATION]},e[g.GET_ROW_NUMBER]=function(t){e[l.ENABLED_PAGINATION]&&(t=(e[l.CURRENT_PAGE]-1)*c.itemsPerPage+t);return t+1};var r={desc:!(e[l.EXPORT_TO_XLS]=function(){XLSX.writeFile(XLSX.utils.table_to_book(e[l.EXPORTING_TABLE],{raw:!0}),(t.ptFilename||"Excel")+".xlsx")})};function n(){var t=o(e[g.TOTAL_LIST],r.property,r.desc);if(e[l.ENABLED_PAGINATION]){var n=c.itemsPerPage;t=i(t,n,(e[l.CURRENT_PAGE]-1)*n)}e[g.LIST]=t}e[g.SORT]=function(t){r.property==t?(r.desc&&(t=void 0),r.desc=!r.desc):r.desc=!1;r.property=t},e[g.IS_ACTIVE]=function(t){return r.property==t},e[g.GET_ICON_CLASS]=function(t){return"fa-sort"+(r.property==t?"-"+(r.desc?"down":"up"):"")},e.$watchCollection(t.ptList,function(t){angular.forEach(t,function(t,n){t[I]=n}),e[g.TOTAL_LIST]=t,n()}),e.$watch(l.CURRENT_PAGE,n),e.$watch(l.ENABLED_PAGINATION,n),e.$watchCollection(function(){return r},n)}}function n(i){return function(e){return{restrict:"C",link:function(t,n){n.parent(".pagination."+u).length&&n.children("a").html(i('<span class="fas fa-chevron-'+(e?"right":"left")+'"></span>')(t))}}}}function e(t){return t()}function i(t){return t(!0)}function o(t){return t(function(t,n){var e=n.ptOrder;t.append('<button type="button" class="btn btn-default btn-xs pull-right btn-pt-records" ng-class="{active: '+g.IS_ACTIVE+"('"+e+'\')}" ng-click="'+g.SORT+"('"+e+'\')"><span class="fas" ng-class="'+g.GET_ICON_CLASS+"('"+e+"')\"></span></button>")},function(t,n,e){e.ptOrderInit&&(t[g.INITIAL_ORDERED_PROPERTY]=e.ptOrder)})}function r(t,c){var s="ptItemManage",l="$$old",u="$$isEditing",f="$startEdition",p="$delete",d="$edit",T="$cancelEdition";return t(function(t,n){n.$set("ngRepeat",(n.ptItem||"$item")+" in "+g.LIST),t.prepend('<td class="text-right">{{'+g.GET_ROW_NUMBER+"($index) | number}}</td>");var e=n[s];e&&t.append('<td><div class="btn-group" role="toolbar" ng-hide="'+g.IS_EDITING+'($index)"><button type="button" class="btn btn-default" ng-click="'+f+'($index)" ng-if="'+e+'.edit"><span class="fas fa-edit"></span></button><button type="button" class="btn btn-default" ng-click="'+p+'($index)" ng-if="'+e+'.delete"><span class="fas fa-trash"></span></button></div><div class="btn-group" role="toolbar" ng-if="'+e+'.edit" ng-show="'+g.IS_EDITING+'($index)"><button type="button" class="btn btn-default" ng-click="'+d+'($index)"><span class="fas fa-check"></span></button><button type="button" class="btn btn-default" ng-click="'+T+'($index)"><span class="fas fa-times"></span></button></div></td>')},function(e,t,n){var i=e.$eval(n[s]);if(!i)return;function o(t){return e[g.LIST][t]}function r(t,n){t&&t.then?t.then(function(){n()}):n()}function a(t){var n=o(t);delete n[l],delete n[u]}e[f]=function(t){var n=o(t);n[l]=angular.copy(n),n[u]=!0},e[p]=function(t){if(c()){var n=o(t);r(i.delete(n),function(){e[g.TOTAL_LIST].splice(n[I],1)})}},e[d]=function(t){var n=o(t);r(i.edit(n,n[l]),function(){a(t)})},e[T]=function(t){var i=o(t);angular.forEach(i,function(t,n){if(n!=l&&n!=u){var e=i[l][n];void 0===e?delete i[n]:i[n]=e}}),a(t)},e[g.IS_EDITING]=function(t){return o(t)[u]}})}function a(t){return function(e){return t(function(t,n){n.$set(e?"ngShow":"ngHide",g.IS_EDITING+"($index)")})}}function c(t){return t()}function s(t){return t(!0)}}(),function(){function t(o){return function(e,i){return{restrict:"A",priority:1e3,terminal:!0,compile:function(t,n){return e(t,n),function(t,n,e){i&&i(t,n,e);n.removeAttr(e.$attr[this.name]),o(n)(t)}}}}}function n(t,n){return function(){return t.confirm(n.deletionConfirmation)}}t.$inject=["$compile"],n.$inject=["$window","PT_RECORDS_TEXTS"],angular.module("proaTools.records").factory("getCompiledDirectiveOptions",t).factory("confirmDeletion",n)}();