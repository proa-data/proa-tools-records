/*!
 * Proa Tools Records v1.4.0 (https://github.com/proa-data/proa-tools-records)
 */
angular.module("proaTools.records",["ngAria","ui.bootstrap"]),function(){function t(t){t.maxSize=5,t.forceEllipses=!0,t.previousText=t.nextText=null,t.boundaryLinkNumbers=!0}t.$inject=["uibPaginationConfig"],angular.module("proaTools.records").config(t)}(),angular.module("proaTools.records").constant("PT_RECORDS_TEXTS",{number:"#",noData:"No data",deletionConfirmation:"Do you really want to delete?"}),function(){t.$inject=["$filter","uibPaginationConfig","PT_RECORDS_TEXTS","$compile"],n.$inject=["$compile"],e.$inject=["getPaginationDirectiveOptions"],i.$inject=["getPaginationDirectiveOptions"],o.$inject=["getAntiloopDirectiveCompileOption"],a.$inject=["getAntiloopDirectiveCompileOption","confirmDeletion"],r.$inject=["getAntiloopDirectiveCompileOption"],c.$inject=["getPtItemManageDirectiveOptions"],l.$inject=["getPtItemManageDirectiveOptions"],angular.module("proaTools.records").directive("ptList",t).factory("getPaginationDirectiveOptions",n).directive("paginationPrev",e).directive("paginationNext",i).directive("ptOrder",o).directive("ptOrderInit",function(){return{restrict:"A",link:function(t,n,e){switch(e[this.name]){case"desc":i();case"asc":i()}function i(){t.sort(t.$initialOrderedProperty)}}}}).directive("ptItem",a).factory("getPtItemManageDirectiveOptions",r).directive("ptItemManageOutput",c).directive("ptItemManageInput",l);var u="$index",s="pagination-pt-records";function t(e,r,a,c){return t.$inject=["$scope","$attrs"],{restrict:"A",scope:!0,controller:t,compile:function(){return function(n,t){var e=0;t.find("thead > tr:first").prepend(o("<th>"+a.number+"</th>")).find("th").each(function(){e+=angular.element(this).prop("colspan")}).end().end().find("tbody").append(o('<tr ng-if="!totalItems.length"><td colspan="'+e+'">'+a.noData+"</td></tr>")),n.exportingTable=t.get(0);var i=t.parent();function o(t){return c(t)(n)}i.hasClass("table-responsive")&&(t=i),t.before(o('<div class="clearfix" ng-show="totalItems.length"><ul uib-pagination total-items="totalItems.length" ng-model="currentPage" class="'+s+' pull-left" ng-show="enabledPagination"></ul><div class="btn-group pull-right" role="group"><button type="button" class="btn btn-default" ng-click="togglePagination()"><span class="fa-stack fa-stack-pt-records" ng-if="enabledPagination"><span class="far fa-file fa-stack-1x"></span><span class="fas fa-slash fa-stack-1x"></span></span><span class="far fa-file" ng-if="!enabledPagination"></span></button><button type="button" class="btn btn-default" ng-click="exportToXls()"><span class="fas fa-file-excel"></span></button></div></div>'))}}};function t(i,t){var o=e("limitTo"),a=e("orderBy");function n(){var t=i.orderConfig,n=a(i.totalItems,t.property,t.desc);if(i.enabledPagination){var e=r.itemsPerPage;i.$list=o(n,e,(i.currentPage-1)*e)}else i.$list=n}i.$list=[],i.totalItems=[],i.currentPage=1,i.enabledPagination=void 0===t.ptNoPagination,i.togglePagination=function(){i.enabledPagination=!i.enabledPagination},i.getRowNumber=function(t){i.enabledPagination&&(t=(i.currentPage-1)*r.itemsPerPage+t);return t+1},i.exportToXls=function(){XLSX.writeFile(XLSX.utils.table_to_book(i.exportingTable),(t.ptFilename||"Excel")+".xlsx")},i.orderConfig={desc:!1},i.sort=function(t){var n=i.orderConfig;n.property==t?(n.desc&&(t=void 0),n.desc=!n.desc):n.desc=!1;n.property=t},i.isActive=function(t){return i.orderConfig.property==t},i.getIconClass=function(t){var n=i.orderConfig;return"fa-sort"+(n.property==t?"-"+(n.desc?"down":"up"):"")},i.$watchCollection(t.ptList,function(t){angular.forEach(t,function(t,n){t[u]=n}),i.totalItems=t,n()}),i.$watch("currentPage",n),i.$watch("enabledPagination",n),i.$watchCollection("orderConfig",n)}}function n(i){return function(e){return{restrict:"C",link:function(t,n){n.parent(".pagination."+s).length&&n.children("a").html(i('<span class="fas fa-chevron-'+(e?"right":"left")+'"></span>')(t))}}}}function e(t){return t()}function i(t){return t(!0)}function o(t){return{restrict:"A",terminal:!0,priority:1e3,compile:t(function(t,n){var e=n.ptOrder;t.append('<button type="button" class="btn btn-default btn-xs pull-right btn-pt-records" ng-class="{active: isActive(\''+e+"')}\" ng-click=\"sort('"+e+'\')"><span class="fas" ng-class="getIconClass(\''+e+"')\"></span></button>")},function(t,n,e){e.ptOrderInit&&(t.$initialOrderedProperty=e.ptOrder)})}}function a(t,c){var s="ptItemManage",l="$manage";return{restrict:"A",terminal:!0,priority:1e3,compile:t(function(t,n){var e=n.ptItem||"$item";n.$set("ngRepeat",e+" in $list"),t.prepend('<td class="text-right">{{getRowNumber($index) | number}}</td>');var i=n[s];i&&t.append('<td><div class="btn-group" role="group" ng-show="!'+e+'.$editing"><button type="button" class="btn btn-default" ng-click="'+l+'.$startEdition($index)" ng-if="'+i+'.edit"><span class="fas fa-edit"></span></button><button type="button" class="btn btn-default" ng-click="'+l+'.$delete($index)" ng-if="'+i+'.delete"><span class="fas fa-trash"></span></button></div><div class="btn-group" role="group" ng-if="'+i+'.edit" ng-show="'+e+'.$editing"><button type="button" class="btn btn-default" ng-click="'+l+'.$edit($index)"><span class="fas fa-check"></span></button><button type="button" class="btn btn-default" ng-click="'+l+'.$cancelEdition($index)"><span class="fas fa-times"></span></button></div></td>')},function(e,t,n){var i=e.$eval(n[s]);function o(t){return e.$list[t]}function a(t,n){t?t.then(function(){n()}):n()}function r(t){var n=o(t);delete n.$old,delete n.$editing}i&&(e[l]={$startEdition:function(t){var n=o(t);n.$old=angular.copy(n),n.$editing=!0},$delete:function(t){if(c()){var n=o(t);a(i.delete(n),function(){e.$apply(function(){e.totalItems.splice(n[u],1)})})}},$edit:function(t){var n=angular.copy(o(t)),e=n.$old;delete n.$old,delete n.$editing,a(i.edit(n,e),function(){r(t)})},$cancelEdition:function(t){var i=o(t);angular.forEach(i,function(t,n){if("$old"!=n&&"$editing"!=n){var e=i.$old[n];void 0===e?delete i[n]:i[n]=e}}),r(t)}},e.$isEditing=function(t){return o(t).$editing})})}}function r(t){return function(e){return{restrict:"A",compile:t(function(t,n){n.$set("ngShow",(e?"":"!")+"$isEditing($index)")})}}}function c(t){return t()}function l(t){return t(!0)}}(),function(){function t(o){return function(e,i){return function(t,n){return e(t,n),function(t,n,e){i&&i(t,n,e),n.removeAttr(e.$attr[this.name]),o(n)(t)}}}}function n(t,n){return function(){return t.confirm(n.deletionConfirmation)}}t.$inject=["$compile"],n.$inject=["$window","PT_RECORDS_TEXTS"],angular.module("proaTools.records").factory("getAntiloopDirectiveCompileOption",t).factory("confirmDeletion",n)}();