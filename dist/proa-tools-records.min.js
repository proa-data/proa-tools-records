/*!
 * Proa Tools Records v1.8.6 (https://github.com/proa-data/proa-tools-records)
 */
angular.module("proaTools.records",["ui.bootstrap"]),function(){function t(t){t.maxSize=10,t.forceEllipses=!0,t.previousText=t.nextText=null,t.boundaryLinkNumbers=!0}t.$inject=["uibPaginationConfig"],angular.module("proaTools.records").config(t)}(),angular.module("proaTools.records").constant("PT_RECORDS_TEXTS",{number:"#",noData:"No data",deletionConfirmation:"Do you really want to delete?"}),function(){t.$inject=["$compile"],e.$inject=["getPaginationDirectiveOptions"],i.$inject=["getPaginationDirectiveOptions"],o.$inject=["getCompiledDirectiveOptions"],r.$inject=["getCompiledDirectiveOptions"],c.$inject=["getPtItemManageDirectiveOptions"],s.$inject=["getPtItemManageDirectiveOptions"];var n={PT_LIST:"ptList",PT_ITEM:"ptItem"};angular.module("proaTools.records").directive(n.PT_LIST,function(r,c,n){var s="$currentPage",u="$enabledPagination",l="$togglePagination",f="$$exportingTable",p="$exportToXls";return{restrict:"A",scope:!0,controller:function(e,t){var i=r("limitTo"),a=r("orderBy");e[I.LIST]=[],e[I.TOTAL_LIST]=[],e[s]=1,e[u]=void 0===t.ptNoPagination,e[l]=function(){e[u]=!e[u]},e[I.GET_ROW_NUMBER]=function(t){e[u]&&(t=(e[s]-1)*c.itemsPerPage+t);return t+1},e[p]=function(){XLSX.writeFile(XLSX.utils.table_to_book(e[f],{raw:!0}),(t.ptFilename||"Excel")+".xlsx")};var o={desc:!1};function n(){var t=a(e[I.TOTAL_LIST],o.property,o.desc);if(e[u]){var n=c.itemsPerPage;t=i(t,n,(e[s]-1)*n)}e[I.LIST]=t}e[I.SORT]=function(t){o.property==t?(o.desc&&(t=void 0),o.desc=!o.desc):o.desc=!1,o.property=t},e[I.IS_ACTIVE]=function(t){return o.property==t},e[I.GET_ICON_CLASS]=function(t){return"fa-sort"+(o.property==t?"-"+(o.desc?"down":"up"):"")},e.$watchCollection(t.ptList,function(t){angular.forEach(t,function(t,n){t[b]=n}),e[I.TOTAL_LIST]=t,n()}),e.$watch(s,n),e.$watch(u,n),e.$watchCollection(function(){return o},n)},compile:function(i){return i.prepend('<caption class="pt-records-toolbar clearfix" ng-show="'+I.TOTAL_LIST+'.length"><ul uib-pagination total-items="'+I.TOTAL_LIST+'.length" ng-model="'+s+'" class="'+a+' pull-left" ng-show="'+u+'"></ul><div class="btn-group pull-right" role="toolbar"><button type="button" class="btn btn-default" ng-click="'+l+'()"><span class="fa-stack fa-stack-pt-records" ng-if="'+u+'"><span class="far fa-file fa-stack-1x"></span><span class="fas fa-slash fa-stack-1x"></span></span><span class="far fa-file" ng-if="!'+u+'"></span></button><button type="button" class="btn btn-default" ng-click="'+p+'()"><span class="fas fa-file-excel"></span></button></div></caption>').find("tbody").append('<tr ng-if="!'+I.TOTAL_LIST+'.length"><td colspan="'+Math.max(t("thead","<th>"+n.number+"</th>"),t("tfoot",'<th class="invisible"></th>'))+'">'+n.noData+"</td></tr>"),function(t,n){t[f]=n.get(0)};function t(t,n){var e=0;return i.find(t+" > tr:first").prepend($(n).prop("rowspan",i.find(t+" > tr").length).get(0)).find("th, td").each(function(){e+=angular.element(this).prop("colspan")}),e}}}}).factory("getPaginationDirectiveOptions",t).directive("paginationPrev",e).directive("paginationNext",i).directive("ptOrder",o).directive("ptOrderInit",function(){return{restrict:"A",link:function(t,n,e){switch(e[this.name]){case"desc":i();case"asc":i()}function i(){t[I.SORT](t[I.INITIAL_ORDERED_PROPERTY])}}}}).directive(n.PT_ITEM,function(t,r,c){var s="ptItemManage",u="$$old",l="$$isEditing",f="$startEdition",p="$delete",d="$edit",g="$cancelEdition";return t(function(t,n){var e=T(n);n.$set("ngRepeat",e+" in "+I.LIST),t.prepend('<td class="text-right">{{'+I.GET_ROW_NUMBER+"($index) | number}}</td>");var i=n[s];i&&t.append('<td><div class="btn-group" role="toolbar" ng-hide="'+I.IS_EDITING+"("+e+')"><button type="button" class="btn btn-default" ng-click="'+f+"("+e+')" ng-if="'+i+'.edit"><span class="fas fa-edit fa-fw"></span></button><button type="button" class="btn btn-default" ng-click="'+p+"("+e+')" ng-if="'+i+'.delete"><span class="fas fa-trash fa-fw"></span></button></div><div class="btn-group" role="toolbar" ng-if="'+i+'.edit" ng-show="'+I.IS_EDITING+"("+e+')"><button type="button" class="btn btn-default" ng-click="'+d+"("+e+')"><span class="fas fa-check fa-fw"></span></button><button type="button" class="btn btn-default" ng-click="'+g+"("+e+')"><span class="fas fa-times fa-fw"></span></button></div></td>')},function(n,t,e){n[I.ITEM_SN]=T(e);var i=n.$eval(e[s]);if(!i)return;function a(t,n){t&&t.then?t.then(function(){n()}):n()}function o(t){delete t[u],delete t[l]}n[f]=function(t){t[u]=angular.copy(t),t[l]=!0},n[p]=function(t){r.confirm(c.deletionConfirmation)&&a(i.delete(t),function(){n[I.TOTAL_LIST].splice(t[b],1)})},n[d]=function(t){a(i.edit(t,t[u]),function(){o(t)})},n[g]=function(i){angular.forEach(i,function(t,n){switch(n){case b:case u:case l:break;default:var e=i[u][n];void 0===e?delete i[n]:i[n]=e}}),o(i)},n[I.IS_EDITING]=function(t){return t[l]}},{require:"^^"+n.PT_LIST,terminal:!0});function T(t){return t.ptItem||"$item"}}).factory("getPtItemManageDirectiveOptions",r).directive("ptItemManageOutput",c).directive("ptItemManageInput",s).directive("tableSticky",function(){return{restrict:"C",link:function(t,n){var o=n.children(".table"),e=o.find("caption").outerHeight()||0;function i(t,n,e,i){var a=i(o,!0);o.children().filter(t).children("tr:not("+n+")").each(function(){var t=$(this);t.children("th, td").css(e,Math.abs(i(t)-a))})}function a(t,n){return t.position().top+(n?e:0)}i("caption + thead, colgroup + thead, thead:first-child",":first-child","top",a),i("tfoot",":last-child","bottom",function(t,n){return a(t,n)+t.outerHeight()})}}});var I={LIST:"$list",TOTAL_LIST:"$totalList",GET_ROW_NUMBER:"$getRowNumber",SORT:"$sort",IS_ACTIVE:"$isActive",GET_ICON_CLASS:"$getIconClass",INITIAL_ORDERED_PROPERTY:"$$initialOrderedProperty",IS_EDITING:"$isEditing",ITEM_SN:"$$itemSn"},b="$$index",a="pagination-pt-records";function t(i){return function(e){return{restrict:"C",link:function(t,n){n.parent(".pagination."+a).length&&n.children("a").html(i('<span class="fas fa-chevron-'+(e?"right":"left")+'"></span>')(t))}}}}function e(t){return t()}function i(t){return t(!0)}function o(t){return t(function(t,n){var e=n.ptOrder;t.append('<button type="button" class="btn btn-default btn-xs pull-right btn-pt-records" ng-class="{active: '+I.IS_ACTIVE+"('"+e+'\')}" ng-click="'+I.SORT+"('"+e+'\')"><span class="fas" ng-class="'+I.GET_ICON_CLASS+"('"+e+"')\"></span></button>")},function(t,n,e){e.ptOrderInit&&(t[I.INITIAL_ORDERED_PROPERTY]=e.ptOrder)},{require:"^^"+n.PT_LIST})}function r(t){return function(e){return t(function(t,n){n.$set(e?"ngShow":"ngHide",I.IS_EDITING+"({{"+I.ITEM_SN+"}})")},void 0,{require:"^^"+n.PT_ITEM})}}function c(t){return t()}function s(t){return t(!0)}}(),function(){function t(a){return function(e,i,t){return angular.merge({restrict:"A",compile:function(t,n){return e(t,n),function(t,n,e){i&&i(t,n,e);n.removeAttr(e.$attr[this.name]),a(n)(t)}}},t)}}t.$inject=["$compile"],angular.module("proaTools.records").factory("getCompiledDirectiveOptions",t)}();